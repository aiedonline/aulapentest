#!/usr/bin/python
import nmap3;

from datetime  import datetime;
from termcolor import colored;

msg1 = colored("+", "green", attrs=["blink"]);
nmap_start = datetime.now();

target = '127.0.0.1';

pynmap = nmap3.Nmap();
versionscan = pynmap.nmap_version_detection(target);

for info in versionscan:
  print("[" + msg1 + "]",  info['port'], info['protocol'], info['state'], info['reason']);
  for chave, valor in info['service'].items():
    msgtmp = colored(chave, "red", attrs=[ "bold"]);
    print("  ", msgtmp, "\t", valor);

nmap_end = datetime.now();
nmap_time = nmap_end - nmap_start;
print("SCAN", nmap_time);

