#!/usr/bin/python
import nmap3;

from datetime  import datetime;
from termcolor import colored;

msg1 = colored("+", "green", attrs=["blink"]);
nmap_start = datetime.now();

target = '192.168.0.1';

pynmap = nmap3.NmapScanTechniques();
vanilla = pynmap.nmap_tcp_scan(target);

for info in vanilla[target]:
  print("[" + msg1 + "]",  info['portid'], info['protocol'], info['state'], info['reason']);
  for chave, valor in info['service'].items():
    msgtmp = colored(chave, "red", attrs=[ "bold"]);
    print("  ", msgtmp, "\t", valor);

nmap_end = datetime.now();
nmap_time = nmap_end - nmap_start;

print("SCAN", nmap_time);
for chave, valor in vanilla["runtime"].items():
  msgtmp = colored(chave, "red", attrs=[ "bold"]);
  print("  ", msgtmp, "\t", valor);
