#!/usr/bin/python
# argscan_001.py
import nmap3;

from datetime  import datetime;
from termcolor import colored;

msg1 = colored("+", "green", attrs=["blink"]);
nmap_start = datetime.now();

target = '192.168.0.1';

pynmap = nmap3.Nmap();
vanilla = pynmap.scan_top_ports(target, args='-sC -n -T5');

for info in vanilla[target]:
  print("[" + msg1 + "]",  info['portid'], info['protocol'], info['state'], info['reason']);
  for chave, valor in info['service'].items():
    msgtmp = colored(chave, "red", attrs=[ "bold"]);
    print("  ", msgtmp, "\t", valor);
nmap_end = datetime.now();

nmap_time = nmap_end - nmap_start;

print("Tempo de execução", nmap_time);

for chave, valor in vanilla["runtime"].items():
  msgtmp = colored(chave, "red", attrs=[ "bold"]);
  print("  ", msgtmp, "\t", valor);
